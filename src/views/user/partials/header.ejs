<link rel="stylesheet" href="/css/navbar.css">
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
/>
<style>
  body {
    font-family: Arial, sans-serif;
}

.top-actions {
    position: relative;
 left: 140px;
    display: inline-block;
}

.action-item {
    cursor: pointer;
    padding: 1px;
  
    color: black;
    border-radius: 5px;
    display: flex;
    align-items: center;
    gap: 5px;
    user-select: none;
}

.action-item:hover {
    
}

/* Dropdown menu styling */
.dropdown-menu {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    background: white;
    min-width: 150px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    border-radius: 5px;
    overflow: hidden;
    z-index: 100;
}

.dropdown-menu a {
    display: block;
    padding: 10px 15px;
    color: #333;
    text-decoration: none;
}

.dropdown-menu a:hover {
    background: #f0f0f0;
}
.logo img {
  height: 60px;
  object-fit: contain;
}
</style>

<!-- TOP NAVBAR -->
<div class="top-navbar">

  <div class="logo">
  <a href="/">
    <img src="/uploads/autokart_logo.jpeg" alt="Autokart Logo" style="height: 60px; object-fit: contain;">
  </a>
</div>


<div class="search-box">
  <input
    id="searchInput"
    type="text"
    placeholder="Search Decoration Products"
    autocomplete="off"
  >
  <button type="button">
    <i class="fa fa-search"></i>
  </button>

  <div id="searchDropdown" class="search-dropdown"></div>
</div>



<div class="top-actions">
    <div class="action-item" id="loginBtn">
        <i class="fa fa-user"></i>
        <span>Login</span>
        <i class="fa fa-caret-down" style="margin-left:5px;"></i>
    </div>
    <div class="dropdown-menu" id="loginDropdown">
        <a href="/admin/customer_login">Customer Login</a>
        <a href="/admin/my_profile">My Profile</a>
    </div>
</div>

    <div class="action-item">
  <a href="/cart" class="cart-link">
    <i class="fa fa-shopping-cart"></i>
    <span>Cart</span>
  </a>
</div>

    </div>
  </div>

</div>

<!-- MAIN MENU -->
<div class="menu-navbar">
  <ul>

    <li class="active">
      <a href="/">Home</a>
    </li>

    <% if (typeof sections !== "undefined") { %>
      <% sections.forEach(section => { %>

        <li class="dropdown">
          <a href="/section/<%= section.display_slug %>">
            <%= section.name %>
          </a>

          <% if (
            typeof subSectionsBySection !== "undefined" &&
            subSectionsBySection[section.id]
          ) { %>

            <div class="dropdown-menu">
              <% subSectionsBySection[section.id].forEach(sub => { %>
                <a href="/sub-section/<%= sub.display_slug %>">
                  <%= sub.name %>
                </a>
              <% }) %>
            </div>

          <% } %>
        </li>

      <% }) %>
    <% } %>

    <li>
      <a href="/track-order">Track Order</a>
    </li>

    <li>
      <a href="/gallery">Gallery</a>
    </li>

    <li>
      <a href="/dealer">Become Dealer</a>
    </li>

    <li>
      <a href="/contact">Contact</a>
    </li>

  </ul>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const loginBtn = document.getElementById('loginBtn');
    const dropdown = document.getElementById('loginDropdown');

    loginBtn.addEventListener('click', () => {
        dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
    });

    document.addEventListener('click', (e) => {
        if (!loginBtn.contains(e.target) && !dropdown.contains(e.target)) {
            dropdown.style.display = 'none';
        }
    });
});
</script>

<script>







  console.log("SEARCH JS LOADED");

const input = document.getElementById("searchInput");
const dropdown = document.getElementById("searchDropdown");

input.addEventListener("keyup", async () => {
  const q = input.value.trim();

  if (q.length < 2) {
    dropdown.style.display = "none";
    dropdown.innerHTML = "";
    return;
  }

  const res = await fetch(`/api/search?q=${q}`);
  const data = await res.json();

  dropdown.innerHTML = "";
  dropdown.style.display = "block";

  data.forEach(item => {
    dropdown.innerHTML += `
      <a href="/product/${item.display_slug}" class="search-item">
        <img src="/uploads/${item.image}">
        <div>
          <div class="name">${item.product_name}</div>
          <div class="price">â‚¹ ${item.price}</div>
        </div>
      </a>
    `;
  });
});
</script>
