<link rel="stylesheet" href="/css/navbar.css">

<link rel="stylesheet" href="/css/navbar.css">
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
/>

<!-- ================= TOP NAVBAR ================= -->
<div class="top-navbar">

  <!-- LOGO -->
  <div class="logo">
    <a href="/">
      <img src="/uploads/autokart_logo.jpeg" alt="Autokart Logo">
    </a>
  </div>

  <!-- SEARCH -->
  <div class="search-box">
    <input
      id="searchInput"
      type="text"
      placeholder="Search Decoration Products"
      autocomplete="off"
    >
    <button type="button">
      <i class="fa fa-search"></i>
    </button>
    <div id="searchDropdown" class="search-dropdown"></div>
  </div>

  <!-- ACTIONS -->
  <div class="top-actions">

    <!-- LOGIN -->
    <div class="dropdown">
      <div class="action-item">
        <i class="fa fa-user"></i>
        <span>Login</span>
        <i class="fa fa-caret-down"></i>
      </div>

      <div class="dropdown-menu">
        <a href="/admin/customer_login">Customer Login</a>
        <a href="/admin/my_profile">My Profile</a>
      </div>
    </div>

    <!-- CART -->
    <div class="action-item">
      <a href="/cart" class="cart-link">
        <i class="fa fa-shopping-cart"></i>
        <span>Cart</span>
      </a>
    </div>

  </div>
</div>


</div>

<!-- ================= MAIN MENU ================= -->
<div class="menu-navbar">
  <ul>

    <!-- HOME -->
    <li class="active">
      <a href="/">Home</a>
    </li>

    <!-- DYNAMIC SECTIONS -->
    <% if (typeof sections !== "undefined") { %>
      <% sections.forEach(section => { %>

        <li class="nav-dropdown">
          <a href="/section/<%= section.display_slug %>">
            <%= section.name %>
          </a>

          <% if (
            typeof subSectionsBySection !== "undefined" &&
            subSectionsBySection[section.id]
          ) { %>

            <div class="nav-dropdown-menu">
              <% subSectionsBySection[section.id].forEach(sub => { %>
                <a href="/sub-section/<%= sub.display_slug %>">
                  <%= sub.name %>
                </a>
              <% }) %>
            </div>

          <% } %>
        </li>

      <% }) %>
    <% } %>

    <!-- STATIC LINKS -->
    <li>
      <a href="/track-order">Track Order</a>
    </li>

    <li>
      <a href="/gallery">Gallery</a>
    </li>

    <li>
      <a href="/dealer">Become Dealer</a>
    </li>

    <li>
      <a href="/contact">Contact</a>
    </li>

  </ul>
</div>




<script>







  console.log("SEARCH JS LOADED");

const input = document.getElementById("searchInput");
const dropdown = document.getElementById("searchDropdown");

input.addEventListener("keyup", async () => {
  const q = input.value.trim();

  if (q.length < 2) {
    dropdown.style.display = "none";
    dropdown.innerHTML = "";
    return;
  }

  const res = await fetch(`/api/search?q=${q}`);
  const data = await res.json();

  dropdown.innerHTML = "";
  dropdown.style.display = "block";

  data.forEach(item => {
    dropdown.innerHTML += `
      <a href="/product/${item.display_slug}" class="search-item">
        <img src="/uploads/${item.image}">
        <div>
          <div class="name">${item.product_name}</div>
          <div class="price">â‚¹ ${item.price}</div>
        </div>
      </a>
    `;
  });
});
</script>
